# Основні рішення з реалізації компонентів системи

У цьому розділі будуть розглянуті рішення, прийняті під час розробки компонентів системи. Основна увага буде приділена класам, які були розроблені командою, і буде надано загальний огляд рішень, прийнятих щодо реалізації цих класів.

## Основні рішення щодо розроблених класів

Класи, розроблені для цього проєкту, були покликані полегшити різні функціональні можливості застосунку. Вони були обрані на основі їхньої здатності виконувати конкретні завдання та сумісності із загальною архітектурою застосунку. Класи були розроблені так, щоб працювати в гармонії один з одним, утворюючи цілісну систему, яка дозволяє застосунку функціонувати як єдине ціле.

### Клас FormAddedListing

Клас FormAddedListing - це форма, яка відображає деталі оголошення про нерухомість, доданого користувачем. Він відповідає за відображення назви, опису, адреси, ціни та зображення оголошення. Клас також відображає дату останнього перегляду оголошення.

Клас має конструктор, який приймає об'єкт Advertisement як параметр. Цей об'єкт містить деталі оголошення, які потім відображаються на формі. Клас також включає об'єкт toolTipDescription, який використовується для відображення повного опису оголошення, коли користувач наводить курсор на скорочений опис.

Клас також включає блок try-catch, який обробляє будь-які винятки, що можуть виникнути під час завантаження форми. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який відображає користувачеві повідомлення про помилку.

### Клас FormAddListing

Клас FormAddListing - це форма, яка дозволяє користувачам додавати нові оголошення про нерухомість. Вона містить поля для введення назви, опису, адреси та ціни оголошення, а також можливість завантаження зображення. Форма також містить кнопку для додавання оголошення та кнопку для скасування операції.

Клас має приватне поле selectedImagePath, в якому зберігається шлях до вибраного зображення. Це поле використовується для зберігання зображення, яке користувач обирає для завантаження.

Конструктор класу ініціалізує форму і встановлює початковий текст мітки lblImageName "Виберіть зображення".

Метод btnCancel_Click закриває форму при натисканні на кнопку скасування.

Метод btnAdd_Click відповідає за додавання нового оголошення. Спочатку він перевіряє, чи всі поля заповнені і чи ціна не дорівнює нулю. Якщо будь-яка з цих умов не виконана, він виводить повідомлення про помилку і повертається. Якщо всі умови виконано, система просить користувача підтвердити операцію. Якщо користувач підтверджує, він створює новий об'єкт Advertisement з введеними даними, додає його до списку GlobalData.AvailableListings та до списку LoginManager.CurrentUser.AddedListings. Після цього відображається повідомлення про успішне завершення і форма закривається.

Метод txtDescription_TextChanged оновлює поле lblDescriptionCharactersCount поточною кількістю символів у полі опису. Він також змінює колір мітки на основі кількості символів.

Метод btnAddImage_Click дозволяє користувачеві вибрати зображення для завантаження. Він відкриває діалогове вікно, яке дозволяє користувачеві вибрати файл зображення. Якщо вибрано зображення, він зберігає шлях до нього у полі selectedImagePath і відображає назву зображення у мітці lblImageName. Якщо зображення не вибрано, він очищає поле selectedImagePath і встановлює мітку lblImageName у значення "Виберіть зображення".

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormBoughtListing

Клас FormBoughtListing - це форма, яка відображає деталі оголошення про нерухомість, яке було придбано користувачем. Він відповідає за відображення назви, опису, адреси, ціни та зображення оголошення. Він також відображає ім'я продавця та ім'я поточного користувача.

Клас має конструктор, який приймає об'єкт Advertisement як параметр. Цей об'єкт містить деталі оголошення, які потім відображаються на формі. Клас також включає об'єкт toolTipDescription, який використовується для відображення повного опису оголошення, коли користувач наводить курсор на скорочений опис.

Клас також включає блок try-catch, який обробляє будь-які винятки, що можуть виникнути під час завантаження форми. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormBuyListing

Клас FormBuyListing - це форма, яка дозволяє користувачам купувати оголошення про нерухомість. Вона надає користувачеві поля для перегляду назви, опису, адреси, ціни та зображення оголошення, а також імені продавця. Форма також містить кнопку для покупки оголошення та кнопку для закриття форми.

Клас має приватне поле listing, в якому зберігається об'єкт Advertisement, що представляє оголошення, яке купується. Він також має приватне поле formMarket, в якому зберігається об'єкт FormMarket, що представляє форму ринку.

Конструктор класу ініціалізує форму і встановлює початковий текст різних міток у відповідні властивості об'єкта listing. Він також встановлює зображення елемента керування pictureBoxListingImage до зображення об'єкта listing.

Метод btnClose_Click закриває форму при натисканні на кнопку закриття.

Метод btnBuy_Click відповідає за покупку оголошення. Спочатку він перевіряє, чи користувач увійшов в систему. Якщо користувач не зареєстрований або не авторизований, він виводить повідомлення про помилку і завершує роботу. Якщо користувач авторизований, він перевіряє, чи є він продавцем оголошення. Якщо користувач є продавцем, відображається повідомлення про помилку і відбувається завершення роботи. Якщо користувач не є продавцем, він додає об'єкт listing до списку BoughtListings об'єкта CurrentUser і видаляє об'єкт listing зі списку AvailableListings об'єкта FormMarket. Після цього він закриває форму.

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormDevelopers

Клас FormDevelopers - це форма, яка відображає інформацію про розробників застосунку. Вона містить кнопки, які дозволяють користувачеві переглянути репозиторій проєкту на GitHub та ліцензію проєкту.

Конструктор класу ініціалізує форму і встановлює властивість Text форми в порожній рядок, а властивість ControlBox форми в значення false. Це приховує рядок заголовка і блок управління форми, роблячи її схожою на діалогове вікно.

Метод styledButtonGithubLink_Click відповідає за відкриття репозиторію проєкту на GitHub у веб-браузері користувача за замовчуванням. Він використовує метод System.Diagnostics.Process.Start для відкриття URL репозиторію GitHub.

Метод styledButtonLicense_Click відповідає за відкриття ліцензії проєкту у браузері користувача за замовчуванням. Він використовує метод System.Diagnostics.Process.Start для відкриття URL-адреси ліцензії.

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormHelp

Клас FormHelp - це форма, яка надає довідку для програми. Вона містить декілька підказок, які надають інформацію про різні розділи програми.

Конструктор класу ініціалізує форму і встановлює властивість Text форми у порожній рядок, а властивість ControlBox форми у значення false. Це приховує рядок заголовка і блок управління форми, роблячи її схожою на діалогове вікно.

Форма містить декілька текстових блоків, які надають інформацію про різні розділи програми. Кожен блок містить заголовок і абзац, який описує відповідний розділ. Заголовки та абзаци відформатовані з використанням різних шрифтів і розмірів, щоб їх можна було легко розрізнити.

Форма також містить елемент управління MainTitle, який використовується для відображення заголовка форми. Елемент управління MainTitle є користувацьким елементом управління, який використовується в усьому застосунку для відображення заголовка кожної форми.

Форма не містить кнопок або інших інтерактивних елементів управління. Вона призначена лише для ознайомлення з інформацією, яка надається користувачеві.

### Клас FormLogin

Клас FormLogin - це форма, яка дозволяє користувачам увійти до програми. Вона містить поля для введення імені користувача та пароля, а також кнопки для входу, реєстрації та перемикання видимості пароля.

Конструктор класу ініціалізує форму і встановлює властивість PasswordChar текстового поля txtPassword у значення '\*', що приховує введений пароль.

Статичне поле LoginAttempts використовується для відстеження кількості невдалих спроб входу.

Метод ValidateLogin використовується для перевірки облікових даних користувача. Він перевіряє, чи збігаються введені ім'я користувача та пароль з будь-яким користувачем у списку GlobalData.Users. Якщо збіг знайдено, повертається відповідний об'єкт User. Якщо збігу не знайдено, повертається null.

Метод btnLogin_Click відповідає за обробку процесу входу в систему. Спочатку він перевіряє, чи поля імені користувача та пароля не порожні і чи відповідають вони вимогам до довжини. Якщо вони не відповідають вимогам, він виводить повідомлення про помилку і інкрементує поле LoginAttempts. Якщо кількість спроб входу перевищує 3, програма виводить повідомлення і скасовує процес входу. Якщо ім'я користувача та пароль відповідають вимогам, викликається метод ValidateLogin для перевірки облікових даних. Якщо перевірка пройшла успішно, він встановлює поле CurrentUser класу LoginManager на користувача, що пройшов перевірку, додає списки користувача до списку AvailableListings класу GlobalData і встановлює поле IsLoggedIn класу LoginManager у значення true.

Метод btnSignUp_Click відповідає за обробку процесу реєстрації. Він відкриває форму FormSignUp, де користувач може ввести свої дані для створення нового облікового запису. Якщо реєстрація пройшла успішно, він додає нового користувача до списку Users класу GlobalData, встановлює поле CurrentUser класу LoginManager на нового користувача і встановлює поле IsLoggedIn класу LoginManager на true.

Метод btnTogglePasswordVisibility_Click відповідає за перемикання видимості пароля. Він змінює властивість PasswordChar текстового поля txtPassword між '\*' і '\0', що приховує і показує введений пароль відповідно.

Клас також містить блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormMarket

Клас FormMarket - це форма, яка відображає список оголошень про продаж нерухомості. Він забезпечує представлення таблиці даних, яка відображає перелік оголошень, поле пошуку, яке дозволяє користувачеві шукати оголошення, і випадаючі меню, які дозволяють користувачеві сортувати оголошення за назвою, продавцем або ціною.

Конструктор класу ініціалізує форму і встановлює властивість DataSource таблиці даних dataGridViewListings на список AvailableListings класу GlobalData. Вона також встановлює шрифт і відступи для заголовків стовпців і комірок подання сітки даних, а також встановлює початковий вибраний індекс спадних списків сортування на 0.

Методи AddListing та RemoveListing використовуються для додавання та видалення списків зі списку AvailableListings класу GlobalData. Вони оновлюють властивість DataSource таблиці даних dataGridViewListings для відображення змін у списку AvailableListings.

Метод btnSearch_Click відповідає за процес пошуку. Він фільтрує список AvailableListings на основі пошукового запиту і встановлює властивість DataSource таблиці даних dataGridViewListings на відфільтрований список.

Метод txtSearch_Enter відповідає за обробку події натискання клавіші Enter у текстовому полі txtSearch. Він очищає текст підказки та змінює колір переднього плану на чорний, коли вводиться текстовий рядок.

Метод dataGridViewListings_CellDoubleClick відповідає за обробку події подвійного кліку по комірці таблиці даних dataGridViewListings. Він відкриває форму FormBuyListing при подвійному кліку по комірці.

Метод txtSearch_KeyDown відповідає за обробку події натискання клавіші у текстовому полі txtSearch. Він викликає метод btnSearch_Click при натисканні клавіші Enter.

Методи reshowHint та hideHint використовуються для показу та приховування підказок у випадаючих меню.

Методи dropdownSortByName_DropDown, dropdownSortBySeller_DropDown і dropdownSortByPrice_DropDown відповідають за обробку події випадаючого меню. Вони приховують підказку у відповідному випадаючому меню при його відкритті.

Методи dropdownSortByName_DropDownClosed, dropdownSortBySeller_DropDownClosed і dropdownSortByPrice_DropDownClosed відповідають за обробку події закриття випадаючого меню. Вони повторно показують підказку у відповідному випадаючому меню, якщо не вибрано жодного елемента.

Методи dropdownSortByName_SelectedIndexChanged, dropdownSortByPrice_SelectedIndexChanged і dropdownSortBySeller_SelectedIndexChanged відповідають за обробку події зміни індексу випадаючого меню. Вони сортують список AvailableListings на основі вибраного елемента відповідного випадаючого меню і повторно показують підказки в інших випадаючих меню.

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormProfile

Клас FormProfile - це форма, яка відображає профіль поточного користувача. Він надає користувачеві поля для перегляду та редагування його імені користувача, електронної пошти та пароля, а також відображення таблиці даних для перегляду оголошень, які користувач купив або додав.

Конструктор класу ініціалізує форму і встановлює властивість DataSource таблиці даних dataGridViewBoughtListings і dataGridViewAddedListings на списки BoughtListings і AddedListings об'єкта CurrentUser класу LoginManager. Він також встановлює шрифт і відступи заголовків стовпців і комірок таблиці даних, а також встановлює початкові значення текстових полів txtUsername, txtEmail і txtPassword на ім'я, електронну пошту і пароль об'єкта CurrentUser класу LoginManager відповідно.

Метод OpenChildForm використовується для відкриття дочірньої форми на панелі pnlMainContainer форми FormProfile. Він приховує поточну активну форму, додає нову форму до панелі pnlMainContainer і встановлює нову форму як активну.

Метод btnTogglePasswordVisibility_Click відповідає за перемикання видимості пароля. Він змінює властивість PasswordChar текстового поля txtPassword між '\*' і '\0', що приховує і показує введений пароль відповідно.

Метод btnSaveChanges_Click відповідає за процес збереження змін. Спочатку він перевіряє, чи відповідає нове ім'я користувача, адреса електронної пошти та пароль встановленим вимогам. Якщо вони не відповідають вимогам, він виводить повідомлення про помилку. Якщо вони відповідають усім вимогам, він оновлює об'єкт CurrentUser класу LoginManager новим іменем користувача, електронною поштою та паролем, а також скидає тип відображення поля txtPassword.

Методи btnRefreshBoughtListings_Click та btnClearBoughtListings_Click відповідають за обробку кнопок оновлення та очищення куплених списків. Вони оновлюють властивість DataSource таблиці даних dataGridViewBoughtListings для відображення змін у списку BoughtListings об'єкта CurrentUser класу LoginManager.

Методи dataGridViewBoughtListings_CellDoubleClick та dataGridViewAddedListings_CellDoubleClick відповідають за обробку події подвійного кліку на комірці таблиці даних dataGridViewBoughtListings та dataGridViewAddedListings. Вони відкривають форму FormBoughtListings і FormAddedListings при подвійному клацанні на відповідній комірці.

Метод btnAddListing_Click відповідає за обробку кнопки додавання оголошення. Він відкриває форму FormAddListing.

Метод deleteAdvertisementButton_Click відповідає за обробку кнопки видалення оголошення. Він видаляє вибране оголошення зі списку AvailableListings класу GlobalData та списку AddedListings об'єкта CurrentUser класу LoginManager.

Клас також містить блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається методу ExceptionManager.HandleException, який виводить користувачеві повідомлення про помилку.

### Клас FormProfileError

Клас FormProfileError - це форма, яка відображається, коли користувач не зміг увійти в систему. Вона містить інформаційне повідомлення, вікно з картинкою та деяку підказку.

Конструктор класу ініціалізує форму і встановлює властивість Text порожнім рядком, а властивість ControlBox - значенням false. Це приховує рядок заголовка і блок управління форми, роблячи її схожою на діалогове вікно.

Метод InitializeComponent використовується для ініціалізації компонентів форми. Він створює і налаштовує компоненти lblError, logoPictureBox і labelRandomTip. Компонент lblError - це напис, який відображає повідомлення про помилку. logoPictureBox - це вікно з зображенням, у якому відображається піктограма. labelRandomTip - мітка, яка відображає підказку користувачу.

Форма FormProfileError призначена для ознайомлення з інформацією, яка надається користувачеві. Вона не містить жодних кнопок або інших інтерактивних елементів керування.

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається до методу ExceptionManager.HandleException, який відображає користувачеві повідомлення про помилку.

### Клас FormSignUp

Клас FormSignUp - це форма, яка дозволяє користувачам створювати нові облікові записи. Вона містить поля для введення імені користувача, пароля та електронної пошти, а також кнопки для входу та реєстрації.

Конструктор класу ініціалізує форму і встановлює властивість PasswordChar текстових полів txtPassword і txtPasswordConfirm у значення '\*', що приховує введений пароль.

Методи DoesUsernameExist і DoesEmailExist використовуються для перевірки того, чи існує введене ім'я користувача та адреса електронної пошти у списку Users класу GlobalData.

Метод btnSignUp_Click відповідає за обробку процесу реєстрації. Спочатку він перевіряє, чи відповідають введені ім'я користувача, пароль, адреса електронної пошти та підтвердження пароля встановленим вимогам. Якщо вони не відповідають вимогам, він додає повідомлення про помилку до списку errors. Якщо вони відповідають вимогам, програма генерує код підтвердження і надсилає його на введену адресу електронної пошти. Потім відкривається форма InputBox, де користувач може ввести код підтвердження. Якщо введений код збігається зі згенерованим, він встановлює властивості Username, Password та Email класу FormSignUp на введені ім'я користувача, гешований пароль та адресу електронної пошти, а також встановлює властивість DialogResult класу FormSignUp у значення OK.

Методи btnTogglePasswordVisibility_Click та btnTogglePasswordConfirmVisibility_Click відповідають за перемикання видимості пароля та підтвердження пароля. Вони змінюють властивість PasswordChar текстових полів txtPassword і txtPasswordConfirm між '\*' і '\0', що приховує і показує введений пароль відповідно.

Клас також включає блок try-catch у кожному методі, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається до методу ExceptionManager.HandleException, який відображає користувачеві повідомлення про помилку.

### Клас FormWelcome

Клас FormWelcome - це форма, яка відображається, коли користувач вперше відкриває програму. Вона містить привітальне повідомлення, вікно з картинкою та випадкову підказку.

Конструктор класу ініціалізує форму і встановлює властивість Text порожнім рядком, а властивість ControlBox - значенням false. Це приховує рядок заголовка і поле керування форми, роблячи її схожою на діалогове вікно. Також викликається метод DisplayRandomTip для відображення випадкової підказки.

Метод DisplayRandomTip використовується для відображення випадкової підказки. Він вибирає випадкову підказку зі списку tips і встановлює властивість Text мітки labelRandomTip до вибраної підказки.

Метод InitializeComponent використовується для ініціалізації компонентів форми. Він створює та налаштовує компоненти logoPictureBox, labelWelcomeMessage та labelRandomTip. Компонент logoPictureBox - це вікно, у якому відображається зображення. labelWelcomeMessage - це мітка, яка відображає привітальне повідомлення. labelRandomTip - мітка, яка відображає випадкову підказку.

Клас також містить блок try-catch у методі DisplayRandomTip, який обробляє будь-які винятки, що можуть виникнути під час виконання методу. Якщо виникає виняток, він перехоплюється і передається до методу ExceptionManager.HandleException, який відображає користувачеві повідомлення про помилку.

## Основні рішення щодо розробки інтерфейсу

Розробка нашого інтерфейсу була кропітким процесом, в якому основна увага приділялася користувацькому досвіду та зручності використання. Ми вирішили використовувати Visual Studio та C# WinForms .NET для цього завдання, оскільки ці технології пропонують надійну платформу для створення десктопних додатків для Windows. Використання WinForms .NET дозволило нам використати можливості C#, а також забезпечити зручний інтерфейс для проєктування та розробки нашого застосунку.

Інтерфейс був розроблений з чіткою візуальною ієрархією, що спрямовує увагу користувача на найбільш важливі частини програми. Цього було досягнуто завдяки стратегічному використанню кольорів, розміру та товщини тексту, а також інтервалів між рядками. Для розміщення меню ми обрали бічну панель у темних кольорах, що створює чіткий контраст з основною зоною контенту, яка виконана у світлих тонах. Такий вибір дизайну був зроблений для того, щоб виділити основний контент і зменшити візуальне навантаження.

Кнопки в нашому інтерфейсі були стилізовані під фірмовий колір - насичений темно-синій з білим жирним текстом. Таке поєднання було обрано через його високу контрастність, завдяки чому кнопки легко ідентифікуються та виділяються на фоні. Це важливий аспект зручності використання, оскільки він полегшує користувачам взаємодію з інтерфейсом.

Ми також використовували табличні подання даних, які були стилізовані у фірмовому синьому кольорі для заголовків та аквамариновому кольорі для обраного елемента. Ці компоненти були побудовані без границь, щоб зробити інтерфейс чистішим і легшим для очей. Такий підхід не тільки підвищує естетичну привабливість інтерфейсу, але й покращує навігацію.

На додаток до цих елементів, ми використовували різні властивості користувацьких елементів управління в Visual Studio для подальшої кастомізації нашого інтерфейсу. Це дозволило нам пристосувати зовнішній вигляд нашого застосунку до конкретних потреб та вподобань, а також забезпечити його цілісність та логічність.

На закінчення, наш процес розробки інтерфейсу був спільним зусиллям, зосередженим на створенні чистого, витонченого користувацького інтерфейсу з сильним акцентом на користувацькому досвіді та зручності використання. Ми використали можливості Visual Studio та C# WinForms .NET у поєднанні зі стратегічним використанням кольорів, розміру та ваги тексту, а також інтервалів для створення візуально привабливого та зручного для користувача застосунку.

## Обробка виключних ситуацій

Обробкою виключних ситуацій займається спеціальний клас ExceptionManager. Цей клас призначений для обробки винятків, їх обліку та відображення відповідних повідомлень користувачеві. Це статичний клас, тобто до нього можна отримати доступ без створення екземпляра, що дуже зручно, коли нам потрібно обробляти винятки в різних частинах нашого застосунку.

Клас ExceptionManager містить три публічні статичні методи: HandleException, Confirm та ShowInfo.

Метод HandleException призначений для обробки виключень. Він отримує три параметри: об'єкт Exception, рядок body і рядок heading. Об'єкт Exception містить деталі виключення, що виникло. Рядки body та heading використовуються для відображення користувачеві вікна з деталями виключення. Метод записує повідомлення про виняток у консоль, а потім виводить вікно з повідомленням про виняток, тілом і заголовком.

Метод Confirm використовується для відображення користувачеві діалогового вікна підтвердження. Він отримує два параметри: рядок body і рядок heading. Метод виводить вікно повідомлення з тілом і заголовком, і дає користувачеві можливість підтвердити або скасувати дію. Метод повертає булеве значення, яке вказує, чи підтвердив користувач дію.

Метод ShowInfo використовується для відображення інформаційного повідомлення користувачеві. Він отримує два параметри: рядок body і рядок heading. Метод виводить вікно повідомлення з тілом і заголовком.

Нижче наведено місця, де оброблено виключення з використанням відповідного класу:
